import React, { useState } from 'react';
import { CheckCircle2, Copy, ExternalLink, AlertCircle, Terminal, Zap, FileCode, Settings } from 'lucide-react';

export default function CompleteSetupGuide() {
  const [copiedFile, setCopiedFile] = useState(null);

  const copyToClipboard = (text, fileName) => {
    navigator.clipboard.writeText(text);
    setCopiedFile(fileName);
    setTimeout(() => setCopiedFile(null), 2000);
  };

  const files = {
    workflow: {
      path: '.github/workflows/daily-brief.yml',
      content: `name: Daily Dashboard Orchestrator

on:
  schedule:
    - cron: '0 13 * * *'  # 1 PM UTC daily
  workflow_dispatch:

permissions:
  contents: write

jobs:
  generate-daily-brief:
    runs-on: ubuntu-latest
    
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4
        with:
          token: \${{ secrets.GITHUB_TOKEN }}
      
      - name: Set up Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '20'
          cache: 'npm'
      
      - name: Install dependencies
        run: npm ci
      
      - name: Generate Daily Brief
        env:
          OPENROUTER_API_KEY: \${{ secrets.OPENROUTER_API_KEY }}
        run: |
          node scripts/generate-brief.js
      
      - name: Commit and Push Changes
        run: |
          git config --local user.email "github-actions[bot]@users.noreply.github.com"
          git config --local user.name "github-actions[bot]"
          git add index.html briefs/
          
          if git diff --staged --quiet; then
            echo "No changes to commit"
          else
            git commit -m "üìä Daily Brief: $(date -u +'%Y-%m-%d %H:%M UTC')"
            git push
          fi`
    },
    packageJson: {
      path: 'package.json',
      content: `{
  "name": "dashboard-orchestrator-pro",
  "version": "1.0.0",
  "description": "AI-powered daily market intelligence aggregator",
  "main": "scripts/generate-brief.js",
  "scripts": {
    "generate": "node scripts/generate-brief.js",
    "test": "node scripts/generate-brief.js"
  },
  "dependencies": {
    "node-fetch": "^3.3.2"
  },
  "engines": {
    "node": ">=18.0.0"
  }
}`
    },
    gitignore: {
      path: '.gitignore',
      content: `node_modules/
package-lock.json
.env
.env.local
.vscode/
.idea/
*.log
.DS_Store`
    }
  };

  const steps = [
    {
      number: 1,
      title: "Create GitHub Repository",
      icon: <Terminal className="w-5 h-5" />,
      commands: [
        "mkdir dashboard-orchestrator-pro",
        "cd dashboard-orchestrator-pro",
        "git init",
        "npm init -y"
      ]
    },
    {
      number: 2,
      title: "Copy Required Files",
      icon: <FileCode className="w-5 h-5" />,
      description: "Use the copy buttons below to copy each file's content"
    },
    {
      number: 3,
      title: "Update Configuration",
      icon: <Settings className="w-5 h-5" />,
      tasks: [
        "Replace YOUR_USERNAME with your GitHub username in generate-brief.js",
        "Update dashboard URLs in the DASHBOARDS object",
        "Verify all 6 dashboard URLs are correct"
      ]
    },
    {
      number: 4,
      title: "Get OpenRouter API Key",
      icon: <Zap className="w-5 h-5" />,
      tasks: [
        "Visit openrouter.ai and sign up",
        "Generate a free API key",
        "Copy the key for next step"
      ],
      link: "https://openrouter.ai"
    },
    {
      number: 5,
      title: "Add GitHub Secret",
      icon: <AlertCircle className="w-5 h-5" />,
      tasks: [
        "Go to repository Settings ‚Üí Secrets and variables ‚Üí Actions",
        "Click 'New repository secret'",
        "Name: OPENROUTER_API_KEY",
        "Value: Paste your API key",
        "Click 'Add secret'"
      ]
    },
    {
      number: 6,
      title: "Enable GitHub Pages",
      icon: <ExternalLink className="w-5 h-5" />,
      tasks: [
        "Go to Settings ‚Üí Pages",
        "Source: Deploy from a branch",
        "Branch: main / (root)",
        "Click Save"
      ]
    },
    {
      number: 7,
      title: "Push to GitHub",
      icon: <Terminal className="w-5 h-5" />,
      commands: [
        "git add .",
        "git commit -m 'Initial setup'",
        "git remote add origin https://github.com/YOUR_USERNAME/dashboard-orchestrator-pro.git",
        "git push -u origin main"
      ]
    },
    {
      number: 8,
      title: "Trigger First Run",
      icon: <CheckCircle2 className="w-5 h-5" />,
      tasks: [
        "Go to Actions tab",
        "Select 'Daily Dashboard Orchestrator'",
        "Click 'Run workflow' ‚Üí 'Run workflow'"
      ]
    }
  ];

  return (
    <div className="min-h-screen bg-gradient-to-br from-slate-900 via-blue-900 to-slate-900 p-6">
      <div className="max-w-6xl mx-auto">
        {/* Header */}
        <div className="bg-gradient-to-r from-blue-600 to-purple-600 rounded-2xl shadow-2xl p-8 mb-8 text-white">
          <h1 className="text-4xl font-bold mb-2">üìä Dashboard Orchestrator Pro</h1>
          <p className="text-xl opacity-90">Complete Setup Guide</p>
          <div className="mt-4 flex flex-wrap gap-3">
            <span className="bg-white/20 px-4 py-2 rounded-lg text-sm">6 Dashboards</span>
            <span className="bg-white/20 px-4 py-2 rounded-lg text-sm">AI-Powered</span>
            <span className="bg-white/20 px-4 py-2 rounded-lg text-sm">Daily Updates</span>
            <span className="bg-white/20 px-4 py-2 rounded-lg text-sm">Free Tier</span>
          </div>
        </div>

        {/* Dashboard URLs Reference */}
        <div className="bg-slate-800 rounded-2xl shadow-xl p-6 mb-8 border border-blue-500/20">
          <h2 className="text-2xl font-bold text-white mb-4">üìç Your Dashboard URLs</h2>
          <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
            {[
              { name: 'Crash Detector', repo: 'Crash_Detector', icon: 'üö®' },
              { name: 'Hyper Analytical', repo: 'hyper-analytical', icon: '‚Çø' },
              { name: 'Market Intel', repo: 'Crypto_Public', icon: 'üìä' },
              { name: 'Economic Compass', repo: 'EconomicCompass', icon: 'üß≠' },
              { name: 'AI Race', repo: 'AI_RACE_CLEAN', icon: 'ü§ñ' },
              { name: 'Intelligence Platform', repo: 'Intelligence_Platform', icon: 'üéØ' }
            ].map((dash, i) => (
              <div key={i} className="bg-slate-700/50 p-4 rounded-lg border border-blue-500/10">
                <div className="flex items-center gap-2 mb-2">
                  <span className="text-2xl">{dash.icon}</span>
                  <span className="font-semibold text-white">{dash.name}</span>
                </div>
                <code className="text-xs text-blue-300 break-all">
                  YOUR_USERNAME.github.io/{dash.repo}/
                </code>
              </div>
            ))}
          </div>
        </div>

        {/* File Downloads */}
        <div className="bg-slate-800 rounded-2xl shadow-xl p-6 mb-8 border border-blue-500/20">
          <h2 className="text-2xl font-bold text-white mb-4">üìÑ Required Files</h2>
          
          {Object.entries(files).map(([key, file]) => (
            <div key={key} className="mb-6 last:mb-0">
              <div className="flex items-center justify-between mb-2">
                <span className="font-mono text-sm text-blue-300">{file.path}</span>
                <button
                  onClick={() => copyToClipboard(file.content, key)}
                  className="flex items-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition"
                >
                  {copiedFile === key ? (
                    <>
                      <CheckCircle2 className="w-4 h-4" />
                      Copied!
                    </>
                  ) : (
                    <>
                      <Copy className="w-4 h-4" />
                      Copy
                    </>
                  )}
                </button>
              </div>
              <pre className="bg-slate-900 p-4 rounded-lg overflow-x-auto text-sm text-gray-300 border border-slate-700">
                {file.content}
              </pre>
            </div>
          ))}
          
          <div className="mt-6 bg-yellow-500/10 border border-yellow-500/20 rounded-lg p-4">
            <div className="flex items-start gap-3">
              <AlertCircle className="w-5 h-5 text-yellow-400 flex-shrink-0 mt-0.5" />
              <div>
                <p className="text-yellow-300 font-semibold mb-2">Important:</p>
                <p className="text-gray-300 text-sm">
                  The main script (generate-brief.js) is in the previous artifact. 
                  Scroll up to copy it or view it in the artifacts panel.
                </p>
              </div>
            </div>
          </div>
        </div>

        {/* Setup Steps */}
        <div className="bg-slate-800 rounded-2xl shadow-xl p-6 mb-8 border border-blue-500/20">
          <h2 className="text-2xl font-bold text-white mb-6">üöÄ Setup Steps</h2>
          
          <div className="space-y-6">
            {steps.map((step) => (
              <div key={step.number} className="bg-slate-700/50 rounded-xl p-6 border border-blue-500/10">
                <div className="flex items-start gap-4">
                  <div className="bg-blue-600 text-white w-10 h-10 rounded-full flex items-center justify-center font-bold flex-shrink-0">
                    {step.number}
                  </div>
                  <div className="flex-1">
                    <div className="flex items-center gap-2 mb-3">
                      <div className="text-blue-400">{step.icon}</div>
                      <h3 className="text-xl font-bold text-white">{step.title}</h3>
                    </div>
                    
                    {step.description && (
                      <p className="text-gray-300 mb-3">{step.description}</p>
                    )}
                    
                    {step.commands && (
                      <div className="bg-slate-900 rounded-lg p-4 font-mono text-sm">
                        {step.commands.map((cmd, i) => (
                          <div key={i} className="text-green-400 mb-2 last:mb-0">
                            <span className="text-gray-500">$ </span>{cmd}
                          </div>
                        ))}
                      </div>
                    )}
                    
                    {step.tasks && (
                      <ul className="space-y-2">
                        {step.tasks.map((task, i) => (
                          <li key={i} className="flex items-start gap-2 text-gray-300">
                            <CheckCircle2 className="w-5 h-5 text-green-400 flex-shrink-0 mt-0.5" />
                            <span>{task}</span>
                          </li>
                        ))}
                      </ul>
                    )}
                    
                    {step.link && (
                      <a
                        href={step.link}
                        target="_blank"
                        rel="noopener noreferrer"
                        className="inline-flex items-center gap-2 mt-3 text-blue-400 hover:text-blue-300 transition"
                      >
                        Visit {step.link.replace('https://', '')}
                        <ExternalLink className="w-4 h-4" />
                      </a>
                    )}
                  </div>
                </div>
              </div>
            ))}
          </div>
        </div>

        {/* Success Banner */}
        <div className="bg-gradient-to-r from-green-600 to-emerald-600 rounded-2xl shadow-xl p-8 text-white">
          <div className="flex items-center gap-4 mb-4">
            <CheckCircle2 className="w-12 h-12" />
            <div>
              <h2 className="text-3xl font-bold">Ready to Launch!</h2>
              <p className="text-lg opacity-90">Your AI-powered command center awaits</p>
            </div>
          </div>
          
          <div className="bg-white/20 rounded-xl p-4 mt-4">
            <p className="text-sm mb-2">Your dashboard will be live at:</p>
            <code className="text-lg font-mono">
              https://YOUR_USERNAME.github.io/dashboard-orchestrator-pro/
            </code>
          </div>
          
          <div className="mt-6 grid grid-cols-1 md:grid-cols-3 gap-4 text-sm">
            <div className="bg-white/10 rounded-lg p-3">
              <div className="font-bold mb-1">‚è∞ Updates</div>
              <div className="opacity-90">Daily at 1 PM UTC</div>
            </div>
            <div className="bg-white/10 rounded-lg p-3">
              <div className="font-bold mb-1">ü§ñ AI Model</div>
              <div className="opacity-90">TNG R1T Chimera (Free)</div>
            </div>
            <div className="bg-white/10 rounded-lg p-3">
              <div className="font-bold mb-1">üìä Sources</div>
              <div className="opacity-90">6 Specialized Dashboards</div>
            </div>
          </div>
        </div>

        {/* Footer */}
        <div className="mt-8 text-center text-gray-400 text-sm">
          <p>Need help? Check the README.md or open an issue on GitHub</p>
          <p className="mt-2">Made with ‚ù§Ô∏è for intelligent market analysis</p>
        </div>
      </div>
    </div>
  );
}